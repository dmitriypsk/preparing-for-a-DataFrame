import pandas as pd

# Загрузка данных из Excel файла
data = pd.read_excel("/Users/dmitriy/Downloads/задание_2_тендер.xlsx", sheet_name="Исходные данные")

# Сохранение исходного адреса для дальнейшего использования
data['Original Address'] = data['Адрес'].copy()

# Извлечение индекса из адреса
data['Индекс'] = data['Адрес'].str.extract(r'(\d{6})')
data['Адрес'] = data['Адрес'].str.replace(r'\d{6},\s?', '', 1)

# Извлечение населенного пункта из адреса
data['Населенный пункт'] = data['Адрес'].str.extract(r'г\.(.*?),')
data['Адрес'] = data['Адрес'].str.replace(r'г\..*?,', '', 1).str.strip()

# Извлечение улицы, номера дома и корпуса из адреса
data['Улица'] = data['Адрес'].str.extract(r'(ул\..*?|пр-кт.*?),')[0]
data['Дом'] = data['Адрес'].str.extract(r'д\.(.*?)(,|$)')[0]
data['Корпус'] = data['Адрес'].str.extract(r'корп\.(.*?)(,|$)')[0]

# Удаление префикса "ул." из названия улицы
data['Улица'] = data['Улица'].str.replace(r'ул\.', '').str.strip()

# Удаление упоминания "оф." из корпуса
data['Корпус'] = data['Корпус'].str.replace(r'оф\..*$', '').str.strip()

# Окончательная очистка и переупорядочивание столбцов
final_data = data[['Название ЛПУ', 'Original Address', 'Индекс', 'Населенный пункт', 'Улица', 'Дом', 'Корпус']]
final_data.columns = ['Название ЛПУ', 'Адрес', 'Индекс', 'Населенный пункт', 'Улица', 'Дом', 'Корпус']

# Сохранение результатов в новый Excel файл
final_data.to_excel("/Users/dmitriy/Downloads/задание_2_тендер_processed.xlsx", index=False)

# Вывод первых 10 строк обработанных данных
print(final_data.head(10))

# В примере была ошибка с корпусом у Вас написано 2 корпус (ООО "Медицина АльфаСтрахования"	183025, г.Мурманск, ул.Капитана Буркова, д.32, корп.1	183025	Мурманск	Капитана Буркова	32	2)